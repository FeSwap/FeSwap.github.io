<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="FeSwap is live on Polygon Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="FeSwap is live on Polygon Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Contract Staking Reward | FeSwap is live on Polygon</title><meta data-react-helmet="true" property="og:url" content="https://wwww.feswap.io/docs/Contracts/StakingTwinRewards"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Contract Staking Reward | FeSwap is live on Polygon"><meta data-react-helmet="true" name="description" content="Staking Reward Contact"><meta data-react-helmet="true" property="og:description" content="Staking Reward Contact"><link data-react-helmet="true" rel="shortcut icon" href="/img/Fesw.png"><link data-react-helmet="true" rel="canonical" href="https://wwww.feswap.io/docs/Contracts/StakingTwinRewards"><link data-react-helmet="true" rel="alternate" href="https://wwww.feswap.io/docs/Contracts/StakingTwinRewards" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wwww.feswap.io/cn/docs/Contracts/StakingTwinRewards" hreflang="cn"><link data-react-helmet="true" rel="alternate" href="https://wwww.feswap.io/docs/Contracts/StakingTwinRewards" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4583fa56.css">
<link rel="preload" href="/assets/js/runtime~main.42223640.js" as="script">
<link rel="preload" href="/assets/js/main.145fee57.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/Fesw.png" alt="FeSwap Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/Fesw.png" alt="FeSwap Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">FeSwap Exchange</b></a><a class="navbar__item navbar__link" href="/docs/Polygon/governance">On Polygon</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__item navbar__link">Tutorial</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Swap">Swap</a></li><li><a class="dropdown__link" href="/Liquidity">Liquidity</a></li><li><a class="dropdown__link" href="/Mining">Mining</a></li><li><a class="dropdown__link" href="/NFT">NFT</a></li><li><a class="dropdown__link" href="/Sponsor">Sponsor</a></li></ul></div><a href="https://app.feswap.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>App<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://ipfs.feswap.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>@ipfs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs ðŸ“š</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog">Blog ðŸ’¬</a></li><li><a class="dropdown__link" href="/download">Download â¤µ</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/Contracts/StakingTwinRewards" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/cn/docs/Contracts/StakingTwinRewards" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ä¸­æ–‡</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">FeSwap Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FeSwap Know-How</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">FeSwap Contracts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/fesw">FESW DAO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/factory">Factory</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/router">Router</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/nft">Token Pair NFT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/sponsor">Sponsor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/StakingTwinRewardsFactory">Staking Reward Factory</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/Contracts/StakingTwinRewards">Staking Reward</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/Timelock">TimeLock</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Contracts/FeswGovernor">FeSwap Governor</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FeSwap Governance</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FreeSwap Exchange Protocol</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FeSwap on Polygon</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Coming FeSwap Networks</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col"><div class="docItemContainer_33ec"><article><div class="markdown"><div class="title"><header><h1 class="h1Heading_27L5"> Staking Reward Contact </h1></header></div><hr><p>FeSwap staking reward contact receives liquidity token deposited by users, and distributes FESW tokens based on the amount and duration of deposited liquidity tokens. </p><p>One staking reward contact is created for one token pair. Normally just a very few of token pairs are rewarded for staking. </p><p>ETH/WBTC, ETH/USDT, ETH/FESW are the first 3 token pairs scheduled to be rewarded for staking during the firts 4 months at the first year. </p><p>On ETH test chain, only ETH/FESW token pair is rewarded for staking at this test phase. Totally 10,000,000 FESW are filled as the reward for the duration of 4 month.</p><p>As each token pair has two liquidity sub-pools, the two liquidity tokens of the two liquidity sub-pools are rewarded completely same.   </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="staking-reward-contract-address"></a><span class="title"> Staking Reward Contract Address </span><a class="hash-link" href="#staking-reward-contract-address" title="Direct link to heading">#</a></h3><table><thead><tr><th align="center">ETH NetWork</th><th align="center">Token Pair</th><th align="center">Staking Reward Contract Address</th></tr></thead><tbody><tr><td align="center">ETH Mainnet</td><td align="center">ETH/WBTC</td><td align="center"><a href="https://etherscan.io/address/0xac262b589b785e48e2a331cb9caf86ffaf069f91" target="_blank" rel="noopener noreferrer">0xaC262B589b785e48E2A331Cb9cAf86fFAf069f91</a></td></tr><tr><td align="center">ETH Mainnet</td><td align="center">ETH/USDT</td><td align="center"><a href="https://etherscan.io/address/0x23d04f77063f60042aab7aaedf14addbd7be6ee9" target="_blank" rel="noopener noreferrer">0x23D04f77063f60042aAB7aAEDF14ADDbd7bE6Ee9</a></td></tr><tr><td align="center">ETH Mainnet</td><td align="center">ETH/USDC</td><td align="center"><a href="https://etherscan.io/address/0xa4a0b0a90f1574d02c55577f7aa5a698ca4b47c8" target="_blank" rel="noopener noreferrer">0xA4A0B0A90f1574d02c55577f7aA5a698Ca4B47c8</a></td></tr><tr><td align="center">ETH Mainnet</td><td align="center">ETH/FESW</td><td align="center"><a href="https://etherscan.io/address/0x33b6af4a9ce826621f6c89fe8563337f8a1ca51e" target="_blank" rel="noopener noreferrer">0x33B6af4A9ce826621F6c89Fe8563337f8A1CA51e</a></td></tr><tr><td align="center">ETH Testnet Ropsten</td><td align="center">ETH/FESW</td><td align="center"><a href="https://ropsten.etherscan.io/address/0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf" target="_blank" rel="noopener noreferrer">0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf</a></td></tr><tr><td align="center">ETH Testnet Rinkeby</td><td align="center">ETH/FESW</td><td align="center"><a href="https://rinkeby.etherscan.io/address/0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf" target="_blank" rel="noopener noreferrer">0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf</a></td></tr><tr><td align="center">ETH Testnet Goerli</td><td align="center">ETH/FESW</td><td align="center"><a href="https://goerli.etherscan.io/address/0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf" target="_blank" rel="noopener noreferrer">0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf</a></td></tr><tr><td align="center">ETH Testnet Kovan</td><td align="center">ETH/FESW</td><td align="center"><a href="https://kovan.etherscan.io/address/0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf" target="_blank" rel="noopener noreferrer">0xC6e82Ec5B319bbBC8ad63F94873c8E9fD9B1EfDf</a></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sponsor-contract-code"></a><span class="title"> Sponsor Contract Code </span><a class="hash-link" href="#sponsor-contract-code" title="Direct link to heading">#</a></h3><p>The open-source FeSwap <code>StakingTwinRewards</code> contact is stored at <a href="https://github.com/FeSwap/Governance/blob/main/contracts/StakingTwinRewards.sol" target="_blank" rel="noopener noreferrer">Github Governance Project</a> </p><p>Following is the code deployed:</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">StakingTwinRewards.sol</div><div class="codeBlockContent_hGly sol"><pre tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// SPDX-License-Identifier: GPL-3.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity ^0.7.0;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pragma experimental ABIEncoderV2;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;@openzeppelin/contracts/math/Math.sol&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;@openzeppelin/contracts/token/ERC20/SafeERC20.sol&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Inheritance</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;./interfaces/IStakingTwinRewards.sol&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;./RewardsTwinDistributionRecipient.sol&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">contract StakingTwinRewards is IStakingTwinRewards, RewardsTwinDistributionRecipient, ReentrancyGuard {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeMath  for uint256;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeERC20 for IERC20;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    struct AmountWithSignature {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256     amount;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint        deadline;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint8       v;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32     r;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32     s;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== STATE VARIABLES ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    IERC20  public rewardsToken;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    IERC20  public stakingTokenA;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    IERC20  public stakingTokenB;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 public periodFinish = 0;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 public rewardRate = 0;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 public rewardsDuration = 0 days;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 public lastUpdateTime;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 public rewardPerTokenStored;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(address =&gt; uint256) public userRewardPerTokenPaid;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(address =&gt; uint256) public rewards;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 private _totalSupplyA;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 private _totalSupplyB;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(address =&gt; uint256) private _balancesA;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(address =&gt; uint256) private _balancesB;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== CONSTRUCTOR ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address _rewardsDistribution,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address _rewardsToken,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address _stakingTokenA,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address _stakingTokenB</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_stakingTokenA &lt; _stakingTokenB, &quot;Wrong token order&quot;);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        rewardsToken = IERC20(_rewardsToken);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        stakingTokenA = IERC20(_stakingTokenA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        stakingTokenB = IERC20(_stakingTokenB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        rewardsDistribution = _rewardsDistribution;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== VIEWS ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function totalSupply() external override view returns (uint256, uint256) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return (_totalSupplyA, _totalSupplyB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function balanceOf(address account) external override view returns (uint256, uint256) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return (_balancesA[account], _balancesB[account]);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function lastTimeRewardApplicable() public override view returns (uint256) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return Math.min(block.timestamp, periodFinish);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function rewardPerToken() public override view returns (uint256) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 _totalSupply = _totalSupplyA.add(_totalSupplyB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(_totalSupply == 0) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return rewardPerTokenStored;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            rewardPerTokenStored.add(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                lastTimeRewardApplicable().sub(lastUpdateTime).mul(rewardRate).mul(1e18).div(_totalSupply)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function earned(address account) public override view returns (uint256) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return (_balancesA[account].add(_balancesB[account])).mul(rewardPerToken().sub(userRewardPerTokenPaid[account])).div(1e18).add(rewards[account]);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function getRewardForDuration() external override view returns (uint256) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return rewardRate.mul(rewardsDuration);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== MUTATIVE FUNCTIONS ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function stakeWithPermit(AmountWithSignature calldata amountA, AmountWithSignature calldata amountB) external nonReentrant updateReward(msg.sender) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        require( (amountA.amount &gt; 0) || (amountB.amount &gt; 0), &quot;Cannot stake 0&quot;);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(amountA.amount &gt; 0) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _totalSupplyA = _totalSupplyA.add(amountA.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _balancesA[msg.sender] = _balancesA[msg.sender].add(amountA.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // permit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            IFeSwapERC20(address(stakingTokenA)).permit(msg.sender, address(this), amountA.amount, amountA.deadline, amountA.v, amountA.r, amountA.s);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            stakingTokenA.safeTransferFrom(msg.sender, address(this), amountA.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(amountB.amount &gt; 0) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _totalSupplyB = _totalSupplyB.add(amountB.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _balancesB[msg.sender] = _balancesB[msg.sender].add(amountB.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // permit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            IFeSwapERC20(address(stakingTokenB)).permit(msg.sender, address(this), amountB.amount, amountB.deadline, amountB.v, amountB.r, amountB.s);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            stakingTokenB.safeTransferFrom(msg.sender, address(this), amountB.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Staked(msg.sender, amountA.amount, amountB.amount);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function stake(uint256 amountA, uint256 amountB) external override nonReentrant updateReward(msg.sender) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        require( (amountA &gt; 0) || (amountB &gt; 0), &quot;Cannot stake 0&quot;);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if( amountA &gt; 0 ){</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _totalSupplyA = _totalSupplyA.add(amountA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _balancesA[msg.sender] = _balancesA[msg.sender].add(amountA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            stakingTokenA.safeTransferFrom(msg.sender, address(this), amountA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if( amountB &gt; 0 ){</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _totalSupplyB = _totalSupplyB.add(amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _balancesB[msg.sender] = _balancesB[msg.sender].add(amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            stakingTokenB.safeTransferFrom(msg.sender, address(this), amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Staked(msg.sender, amountA, amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function withdraw(uint256 amountA, uint256 amountB) public override nonReentrant updateReward(msg.sender) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        require( (amountA &gt; 0) || (amountB &gt; 0), &quot;Cannot withdraw 0&quot;);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if( amountA &gt; 0 ){</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _totalSupplyA = _totalSupplyA.sub(amountA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _balancesA[msg.sender] = _balancesA[msg.sender].sub(amountA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            stakingTokenA.safeTransfer(msg.sender, amountA);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if( amountB &gt; 0 ){</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _totalSupplyB = _totalSupplyB.sub(amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _balancesB[msg.sender] = _balancesB[msg.sender].sub(amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            stakingTokenB.safeTransfer(msg.sender, amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Withdrawn(msg.sender, amountA, amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function getReward() public override nonReentrant updateReward(msg.sender) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 reward = rewards[msg.sender];</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (reward &gt; 0) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            rewards[msg.sender] = 0;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            rewardsToken.safeTransfer(msg.sender, reward);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            emit RewardPaid(msg.sender, reward);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function exit() external override {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        withdraw(_balancesA[msg.sender], _balancesB[msg.sender]);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        getReward();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== RESTRICTED FUNCTIONS ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function notifyRewardAmount(uint256 reward, uint256 _rewardsDuration) external override onlyRewardsDistribution updateReward(address(0)) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_rewardsDuration &gt; 0 , &quot;Wrong duration&quot;);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (block.timestamp &gt;= periodFinish) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            rewardRate = reward.div(_rewardsDuration);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            uint256 remaining = periodFinish.sub(block.timestamp);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            uint256 leftover = remaining.mul(rewardRate);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            rewardRate = reward.add(leftover).div(_rewardsDuration);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Ensure the provided reward amount is not more than the balance in the contract.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // This keeps the reward rate in the right range, preventing overflows due to</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // very high values of rewardRate in the earned and rewardsPerToken functions;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Reward + leftover must be less than 2^256 / 10^18 to avoid overflow.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint balance = rewardsToken.balanceOf(address(this));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        require(rewardRate &lt;= balance.div(_rewardsDuration), &quot;Provided reward too high&quot;);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        lastUpdateTime = block.timestamp;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        periodFinish = block.timestamp.add(_rewardsDuration);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        rewardsDuration = _rewardsDuration;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        emit RewardAdded(reward, _rewardsDuration);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== MODIFIERS ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modifier updateReward(address account) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        rewardPerTokenStored = rewardPerToken();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        lastUpdateTime = lastTimeRewardApplicable();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (account != address(0)) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            rewards[account] = earned(account);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            userRewardPerTokenPaid[account] = rewardPerTokenStored;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /* ========== EVENTS ========== */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    event RewardAdded(uint256 reward, uint256 _rewardsDuration);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    event Staked(address indexed user, uint256 amountA, uint256 amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    event Withdrawn(address indexed user, uint256 amountA, uint256 amountB);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    event RewardPaid(address indexed user, uint256 reward);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">interface IFeSwapERC20 {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function permit(address owner, address spender, uint value, uint deadline, uint8 v, bytes32 r, bytes32 s) external;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Contracts/StakingTwinRewardsFactory"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Staking Reward Factory</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Contracts/Timelock"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TimeLock Â»</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/Feswap/introduction">FeSwap Governance</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/FreeSwap/abstract">FreeSwap Protocol</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://t.me/FeSwap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/feswap66" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="mailto: desk@feswap.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Contact<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/feswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 FeSwap Decentralized Free Exchange.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.42223640.js"></script>
<script src="/assets/js/main.145fee57.js"></script>
</body>
</html>